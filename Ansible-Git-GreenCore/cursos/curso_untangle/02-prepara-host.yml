---
- name: Install a full arch linux desktop
  hosts: fisicos
  tasks:
    - name: Plantilla de jinja para archivo interfaces
      template:
        src: files/interfaces.j2
        dest: /etc/network/interfaces
        mode: 0644
        owner: root
        group: root
      become: yes
    - name: Define un hostname para equipo fisico
      hostname:
        name: "{{ hostname }}"
      become: yes
    - name: Configura kernel para que funcione como router
      sysctl:
        name: net.ipv4.ip_forward
        value: 1
        sysctl_set: yes
        state: present
        reload: yes
      become: yes
    - name: Instala paquete de LXC
      apt: 
        name: "{{ item }}"
        state: installed
      with_items:
        - lxc
        - lxc-dev
        - python-pip
      become: yes
    - name: Instala dependencias de python para m√≥dulo de ansible de LXC
      pip: name=lxc-python2 state=present
      become: yes
    - name: Configura defaults de LXC
      lineinfile:
        regexp: "^lxc.network.link = lxcbr0"
        dest: "/etc/lxc/default.conf"
        line: "lxc.network.link = br0"
        state: present
        backrefs: yes
      become: yes
